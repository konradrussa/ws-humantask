<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:util="http://www.springframework.org/schema/util"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:akka="http://akka.io/schema/akka" xmlns:jee="http://www.springframework.org/schema/jee"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
                           http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
                           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
                           http://akka.io/schema/akka http://akka.io/akka-1.0.xsd"
	default-lazy-init="true" default-autowire="byName">

<import resource="applicationContext.xml"/>

<bean name="webServer" class="org.eclipse.jetty.server.Server" init-method="start">
        <property name="connectors">
            <list>
                <bean class="org.eclipse.jetty.server.nio.SelectChannelConnector">
                    <property name="host" value="127.0.0.1"/>
                    <property name="port" value="${parent.port}"/>
                </bean>
            </list>
        </property>

        <property name="handler">
        <bean class="org.eclipse.jetty.server.handler.HandlerCollection">
                <property name="handlers">
                    <list>
                        <ref bean="jetty.handlerList" />
                        <bean class="org.eclipse.jetty.server.handler.RequestLogHandler">
                            <property name="requestLog">
                                <bean class="org.eclipse.jetty.server.NCSARequestLog">
                                    <constructor-arg value="c:/WORK/jetty.log" />
                                    <property name="extended" value="false"/>
                                </bean>
                            </property>
                        </bean>



                       <bean class="org.eclipse.jetty.servlet.ServletContextHandler">
                          <property name="contextPath" value="/"/>
                          <property name="sessionHandler">
                            <bean class="org.eclipse.jetty.server.session.SessionHandler"/>
                          </property>
                          <property name="resourceBase" value="c:/WORK"/>
                          <property name="servletHandler">
                            <bean class="org.eclipse.jetty.servlet.ServletHandler">
                              <property name="servlets"> <!-- servlet definition -->
                                <list>
                                <!-- default servlet -->
                                <bean class="org.eclipse.jetty.servlet.ServletHolder">
                                  <property name="name" value="moduleExporter"/>
                                  <property name="servlet">
                                    <!--<bean class="org.eclipse.jetty.servlet.DefaultServlet"/>-->
                                    <bean class="org.springframework.web.context.support.HttpRequestHandlerServlet"/>
                                  </property>
                                  <property name="initParameters">
                                    <map>
                                      <entry key="resourceBase" value="c:/WORK"/>
                                    </map>
                                  </property>
                                </bean>
                                </list>
                              </property>
                              <property name="servletMappings">
                                <list><!-- servlet mapping -->
                                <bean class="org.eclipse.jetty.servlet.ServletMapping">
                                  <property name="pathSpecs">
                                    <list><value>/remoting/ModuleService</value></list>
                                  </property>
                                  <property name="servletName" value="moduleExporter"/>
                                </bean>
                                </list>
                              </property>
                            </bean>
                          </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="jetty.handlerList" class="org.eclipse.jetty.server.handler.HandlerList" />